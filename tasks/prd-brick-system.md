# PRD - 벽돌(Brick) 시스템 구현

## 1. 개요
- 목표: 벽돌깨기 스타일의 벽돌 시스템을 도입하여, 스테이지마다 벽돌이 상단에서 내려오며 하단에 닿으면 게임 오버가 되는 규칙을 추가한다.
- 기존 점수 기반 게임 오버는 제거하고, 벽돌 하단 도달만으로 게임 오버를 판정한다.

## 2. 목표
- 스테이지 시작 시(다음 Stage 시작 시점) 벽돌 2줄을 상단에 스폰하고, 기존 벽돌을 2줄만큼 아래로 이동시킨다.
- 벽돌이 그리드 하단(16줄 초과)에 도달하면 즉시 게임 오버 처리한다.
- 볼-벽돌 충돌 시 체력이 1씩 감소하는 대신, “볼의 점수 계수 × 플레이어 기본 점수”만큼 피해를 주고, 체력이 0 이하이면 파괴한다.
- 각 벽돌은 체력 텍스트(TMP_Text)를 가지고, 체력이 변경될 때마다 갱신한다.

## 3. 유저 스토리
1) 플레이어로서 스테이지마다 새로운 벽돌이 내려오고, 하단에 닿으면 즉시 게임 오버가 되길 원한다.
2) 플레이어로서 볼이 벽돌을 명중시키면 체력이 깎이고, 체력이 0이 되면 파괴되는 것을 보고 싶다.
3) 플레이어로서 내 기본 점수와 볼의 점수 계수가 데미지에 반영되길 원한다.

## 4. 기능 요구사항
1) 벽돌 구조: `BrickInstance` - `BrickController` - `BrickManager` - `BrickFactory` 형태로 관리한다.
2) 그리드: PlayArea 좌측 상단을 (0,0)으로 하는 8×16 그리드(가로 8, 세로 16); 벽돌 크기는 128×64이며 PlayArea(1024×1024)에 맞춰 배치한다.
3) 스폰/이동: 각 스테이지 시작 시 기존 벽돌을 2칸 아래로 이동시키고, 상단에 새 2줄(HP 100 고정)을 스폰한다. 이동 후 16줄 초과 시 게임 오버.
4) 게임 오버: 기존 점수 미달 GameOver 로직은 제거하고, 벽돌이 하단에 닿을 때만 게임 오버 처리한다.
5) 데미지: 볼과 벽돌 충돌 시 피해량 = (볼의 점수 계수 × 플레이어 기본 점수). 체력이 0 이하가 되면 벽돌 파괴.
6) 표시: 각 벽돌은 TMP_Text로 체력을 표시하며, 체력 변경 시 업데이트한다. 벽돌 스프라이트는 기존 리소스를 사용한다.
7) 스테이지 시작 시점: 스테이지 전환(다음 Stage 시작) 시 스폰/이동 로직을 실행한다.

## 5. 비범위 (Out of Scope)
- 벽돌 특수 효과/강화/드롭 아이템 등 추가 기능.
- 체력/데미지 밸런스 조정(현 단계에서는 HP 100, 데미지 산식만 적용).
- 새로운 스프라이트 생성(기존 리소스 활용).

## 6. 설계 고려사항
- PlayArea 기준 좌표계를 사용해 월드 좌표를 계산(좌측 상단 기준).
- 이동/스폰 시 충돌·중첩 없이 그리드 상태를 업데이트할 수 있도록 데이터 구조(2D 배열)로 관리.
- GameOver 트리거를 벽돌 하단 도달로 통합하고, 기존 점수 미달 GameOver 호출부는 비활성화/제거.
- 충돌 처리 시 “볼 점수 계수”와 “플레이어 기본 점수”를 가져오는 경로 명확화 필요.

## 7. 성공 지표
- 스테이지 시작마다 벽돌이 2줄 내려오고, 새 2줄이 정상 스폰된다.
- 벽돌이 16줄을 초과하면 즉시 GameOver가 발생한다.
- 볼 충돌 시 체력이 올바른 데미지 공식으로 감소하고, 0 이하에서 파괴되며 체력 텍스트가 갱신된다.
- 기존 점수 미달 GameOver가 더 이상 발생하지 않는다.

## 8. 남은 질문
- 볼 점수 계수: `BallInstance.ScoreMultiplier`
- 플레이어 기본 점수: `PlayerManager.Current.BaseScore`
