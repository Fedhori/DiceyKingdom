# 강화 다중 슬롯 시스템 PRD

## 1. 소개/개요
아이템 하나에 최대 N개의 강화를 동시에 장착할 수 있도록 시스템을 확장한다. 기존에는 강화가 1개만 적용되어 새 강화가 들어오면 기존 강화가 사라졌으나, 이제는 다중 강화 슬롯(기본 3개)을 지원하고, UI도 강화 리스트를 보여주도록 개선한다. 또한 슬롯이 가득 찼을 때 교체 흐름을 제공한다.

## 2. 목표
- 아이템당 최대 N개의 강화 동시 장착 지원(기본 3개 + 확장 가능)
- 아이템 슬롯에 적용된 강화 아이콘들을 항상 표시
- 강화 보기 버튼은 툴팁 전환 대신 전용 오버레이 패널을 열어 여러 강화 툴팁을 나열
- 강화 슬롯이 가득 찼을 때 교체 플로우 제공
- 아이템 판매 시 모든 강화가 강화 가방으로 이동

## 3. 사용자 스토리
- 플레이어로서, 한 아이템에 여러 강화가 동시에 붙어 있음을 한눈에 보고 싶다.
- 플레이어로서, 강화 슬롯이 가득 찼을 때 어떤 강화를 교체할지 선택하고 싶다.
- 플레이어로서, 아이템 판매 시 강화가 사라지지 않고 강화 가방으로 돌아가길 원한다.

## 4. 기능 요구사항
1. 시스템은 아이템당 적용 가능한 강화 슬롯 수를 최대 N으로 제한해야 한다. 기본 N=3이며, 현재는 GameConfig 상수로 제한한다.
2. 하나의 아이템에 동일한 강화가 여러 번 적용될 수 있어야 하며, 효과는 누적된다.
3. 아이템 슬롯 UI는 적용된 강화의 아이콘을 가로로 나열하여 표시해야 한다(희귀도 배경 포함).
4. 아이템 슬롯의 강화 아이콘은 Play/Shop/Result 모든 단계에서 항상 표시되어야 한다.
5. 강화 보기 버튼을 누르면 기존 툴팁 전환 대신 강화 전용 오버레이 패널이 열린다.
6. 강화 전용 패널은 여러 개의 강화 툴팁을 좌우로 나열해 보여줘야 한다.
7. 강화가 0개인 아이템은 강화 보기 버튼을 숨긴다.
8. 강화 패널은 닫기 버튼으로만 닫힌다.
9. 강화 패널이 열린 상태에서 아이템 선택이 바뀌면 패널은 닫힌다.
10. 강화 슬롯이 꽉 찬 상태에서 새로운 강화를 적용하려고 하면 강화 전용 패널이 열린다.
11. 강화 슬롯이 꽉 찬 상태에서는 기존 강화 툴팁 하단 버튼이 “교체하기”로 표시된다.
12. “교체하기”를 누르면 확인 모달이 뜨며, 본문은 “정말 교체하시겠습니까? 기존 강화는 사라집니다.”로 표시된다.
13. 교체 확인 모달의 제목은 “강화 교체”로 표시된다.
14. 교체가 확정되면 선택한 기존 강화는 삭제되고(강화 가방으로 가지 않음), 새 강화가 같은 슬롯 위치에 적용된다.
15. 강화 패널에는 교체 대상 비교를 위해 신규 강화 툴팁도 함께 표시된다.
16. 아이템 판매 시 해당 아이템에 적용된 모든 강화는 강화 가방으로 이동한다(순서 무관).

## 5. 비목표(범위 제외)
- 강화 효과 밸런싱 변경
- 강화 아이콘/패널의 최종 레이아웃 디자인 작업
- 새로운 강화 종류 추가
- 교체 확인 모달의 문구/레이아웃 변형(문구는 고정)

## 6. 디자인 고려사항
- 아이템 슬롯 내 강화 아이콘은 HorizontalLayoutGroup으로 정렬한다.
- 강화 패널은 오버레이 형태이며, 닫기 버튼이 포함되어야 한다.
- 강화 툴팁은 기존 단일 TooltipView 대신 프리팹 기반 다중 생성 구조가 필요하다.
- “교체하기” 버튼 문구는 로컬라이즈 키로 관리한다.

## 7. 기술 고려사항
- ItemInstance가 단일 강화 필드 대신 List 형태로 다중 강화를 보관하도록 변경 필요.
- 강화 적용/제거/판매/가방 이동 로직 전반에서 다중 리스트를 처리하도록 수정 필요.
- 강화 보기 버튼은 툴팁 전환 로직 대신 전용 패널 토글 로직으로 변경 필요.
- 강화 패널에서 여러 TooltipView를 생성/관리할 컨테이너 구조가 필요.
- 최대 강화 슬롯 수는 GameConfig 상수로 구현하며, 스탯 확장은 이번 범위에서 제외한다.
- 로컬라이즈 키 추가: “교체하기” 버튼 문구, 교체 모달 타이틀/본문.

## 8. 성공 지표
- 하나의 아이템에 최대 N개의 강화가 적용되고, UI에 모두 표시된다.
- 강화 슬롯이 꽉 찬 상태에서 교체 플로우가 정상 작동한다.
- 아이템 판매 시 강화가 모두 강화 가방으로 이동한다.
- 강화 패널에서 여러 툴팁이 정상 표시되며, 선택 변경 시 닫힌다.

## 9. 미해결 질문
- 없음.
